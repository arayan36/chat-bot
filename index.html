<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        
        .message-fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .typing-animation {
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .hover-lift {
            transition: all 0.2s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-1px);
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 2px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
        
        /* Dark mode scrollbar */
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #4b5563;
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        
        .message-content pre {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 12px;
            overflow-x: auto;
            border: 1px solid #e9ecef;
        }
        
        .dark .message-content pre {
            background: #1e293b;
            border-color: #334155;
        }
        
        .message-content code {
            background: #f1f5f9;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 0.875em;
        }
        
        .dark .message-content code {
            background: #334155;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        const App = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isDarkMode, setIsDarkMode] = useState(false);
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [conversations, setConversations] = useState([
                { id: 1, title: 'New Conversation', timestamp: new Date() }
            ]);
            const [activeConversation, setActiveConversation] = useState(1);
            
            const messagesEndRef = useRef(null);
            const inputRef = useRef(null);
            
            // Sample prompts like ChatGPT
            const samplePrompts = [
                {
                    title: "Explain concepts",
                    prompt: "Explain quantum computing in simple terms",
                    icon: "fas fa-lightbulb"
                },
                {
                    title: "Write code",
                    prompt: "Write a Python function to sort a list",
                    icon: "fas fa-code"
                },
                {
                    title: "Creative writing",
                    prompt: "Write a short story about time travel",
                    icon: "fas fa-feather-alt"
                },
                {
                    title: "Plan & organize",
                    prompt: "Create a workout plan for beginners",
                    icon: "fas fa-calendar-alt"
                }
            ];
            
            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages]);
            
            useEffect(() => {
                document.documentElement.classList.toggle('dark', isDarkMode);
            }, [isDarkMode]);
            
            const generateResponse = async (userMessage) => {
                setIsLoading(true);
                
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 1000));
                
                const apiKey = "AIzaSyCo5pNBIH09u4OKfTVhLPAwwg_EpKPRHsM";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ 
                                role: "user", 
                                parts: [{ text: userMessage }] 
                            }]
                        })
                    });
                    
                    const result = await response.json();
                    if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        return "I apologize, but I couldn't generate a proper response. Please try again.";
                    }
                } catch (error) {
                    console.error("API Error:", error);
                    return "I'm experiencing technical difficulties. Please try again in a moment.";
                } finally {
                    setIsLoading(false);
                }
            };
            
            const handleSendMessage = async () => {
                const trimmedInput = input.trim();
                if (!trimmedInput || isLoading) return;
                
                const userMessage = {
                    id: Date.now(),
                    text: trimmedInput,
                    sender: 'user',
                    timestamp: new Date()
                };
                
                setMessages(prev => [...prev, userMessage]);
                setInput('');
                
                // Update conversation title if it's the first message
                if (messages.length === 0) {
                    const title = trimmedInput.length > 40 ? trimmedInput.substring(0, 40) + '...' : trimmedInput;
                    setConversations(prev => prev.map(conv => 
                        conv.id === activeConversation 
                            ? { ...conv, title }
                            : conv
                    ));
                }
                
                try {
                    const responseText = await generateResponse(trimmedInput);
                    const assistantMessage = {
                        id: Date.now() + 1,
                        text: responseText,
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, assistantMessage]);
                } catch (error) {
                    console.error("Error:", error);
                    const errorMessage = {
                        id: Date.now() + 1,
                        text: "I'm sorry, something went wrong. Please try again.",
                        sender: 'assistant',
                        timestamp: new Date()
                    };
                    setMessages(prev => [...prev, errorMessage]);
                }
            };
            
            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };
            
            const startNewConversation = () => {
                const newConversation = {
                    id: Date.now(),
                    title: 'New Conversation',
                    timestamp: new Date()
                };
                setConversations(prev => [newConversation, ...prev]);
                setActiveConversation(newConversation.id);
                setMessages([]);
                setSidebarOpen(false);
            };
            
            const formatMessageText = (text) => {
                // Simple markdown-like formatting
                let formatted = text;
                
                // Bold text
                formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                
                // Italic text
                formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                // Inline code
                formatted = formatted.replace(/`([^`]+)`/g, '<code>$1</code>');
                
                // Line breaks
                formatted = formatted.replace(/\n/g, '<br>');
                
                return formatted;
            };
            
            const MessageBubble = ({ message }) => {
                const isUser = message.sender === 'user';
                
                return (
                    <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} message-fade-in`}>
                        <div className={`flex max-w-[80%] ${isUser ? 'flex-row-reverse' : 'flex-row'} items-start space-x-3`}>
                            {/* Avatar */}
                            <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${
                                isUser 
                                    ? 'bg-blue-600 text-white' 
                                    : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'
                            }`}>
                                {isUser ? 'You' : 'AI'}
                            </div>
                            
                            {/* Message content */}
                            <div className={`rounded-2xl px-4 py-3 ${
                                isUser 
                                    ? 'bg-blue-600 text-white ml-3' 
                                    : 'bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 mr-3'
                            }`}>
                                <div 
                                    className="message-content text-sm leading-relaxed"
                                    dangerouslySetInnerHTML={{ 
                                        __html: formatMessageText(message.text) 
                                    }}
                                />
                            </div>
                        </div>
                    </div>
                );
            };
            
            const TypingIndicator = () => (
                <div className="flex justify-start message-fade-in">
                    <div className="flex items-start space-x-3 max-w-[80%]">
                        <div className="flex-shrink-0 w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm font-medium text-gray-700 dark:text-gray-300">
                            AI
                        </div>
                        <div className="bg-gray-100 dark:bg-gray-800 rounded-2xl px-4 py-3 mr-3">
                            <div className="flex space-x-1">
                                <div className="w-2 h-2 bg-gray-500 rounded-full typing-animation"></div>
                                <div className="w-2 h-2 bg-gray-500 rounded-full typing-animation" style={{animationDelay: '0.2s'}}></div>
                                <div className="w-2 h-2 bg-gray-500 rounded-full typing-animation" style={{animationDelay: '0.4s'}}></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
            
            return (
                <div className={`flex h-screen ${isDarkMode ? 'dark bg-gray-900' : 'bg-white'} text-gray-900 dark:text-gray-100`}>
                    {/* Sidebar */}
                    <div className={`fixed inset-y-0 left-0 z-50 w-80 bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform ${
                        sidebarOpen ? 'translate-x-0' : '-translate-x-full'
                    } transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`}>
                        <div className="flex flex-col h-full">
                            {/* Sidebar header */}
                            <div className="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700">
                                <button
                                    onClick={startNewConversation}
                                    className="flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 hover-lift"
                                >
                                    <i className="fas fa-plus mr-2"></i>
                                    New chat
                                </button>
                                <button
                                    onClick={() => setSidebarOpen(false)}
                                    className="lg:hidden ml-2 p-2 rounded-md text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300"
                                >
                                    <i className="fas fa-times"></i>
                                </button>
                            </div>
                            
                            {/* Conversations list */}
                            <div className="flex-1 overflow-y-auto custom-scrollbar p-2">
                                {conversations.map((conversation) => (
                                    <button
                                        key={conversation.id}
                                        onClick={() => {
                                            setActiveConversation(conversation.id);
                                            setSidebarOpen(false);
                                        }}
                                        className={`w-full text-left p-3 rounded-lg mb-1 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors hover-lift ${
                                            activeConversation === conversation.id 
                                                ? 'bg-gray-200 dark:bg-gray-700' 
                                                : ''
                                        }`}
                                    >
                                        <div className="flex items-center justify-between">
                                            <div className="flex-1 min-w-0">
                                                <p className="text-sm font-medium truncate">{conversation.title}</p>
                                                <p className="text-xs text-gray-500 dark:text-gray-400 mt-1">
                                                    {conversation.timestamp.toLocaleDateString()}
                                                </p>
                                            </div>
                                            <i className="fas fa-ellipsis-v text-gray-400 text-xs ml-2"></i>
                                        </div>
                                    </button>
                                ))}
                            </div>
                            
                            {/* Sidebar footer */}
                            <div className="p-4 border-t border-gray-200 dark:border-gray-700">
                                <button
                                    onClick={() => setIsDarkMode(!isDarkMode)}
                                    className="flex items-center w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg hover-lift"
                                >
                                    <i className={`fas ${isDarkMode ? 'fa-sun' : 'fa-moon'} mr-3`}></i>
                                    {isDarkMode ? 'Light mode' : 'Dark mode'}
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    {/* Main content */}
                    <div className="flex-1 flex flex-col">
                        {/* Header */}
                        <header className="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900">
                            <div className="flex items-center">
                                <button
                                    onClick={() => setSidebarOpen(true)}
                                    className="lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 mr-2"
                                >
                                    <i className="fas fa-bars"></i>
                                </button>
                                <h1 className="text-xl font-semibold">ChatAI</h1>
                            </div>
                        </header>
                        
                        {/* Messages area */}
                        <div className="flex-1 overflow-y-auto custom-scrollbar">
                            {messages.length === 0 ? (
                                // Welcome screen like ChatGPT
                                <div className="flex flex-col items-center justify-center h-full px-4 text-center">
                                    <div className="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-6">
                                        <i className="fas fa-robot text-2xl text-white"></i>
                                    </div>
                                    <h2 className="text-2xl font-semibold mb-4">How can I help you today?</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 max-w-2xl w-full">
                                        {samplePrompts.map((item, index) => (
                                            <button
                                                key={index}
                                                onClick={() => setInput(item.prompt)}
                                                className="p-4 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 text-left transition-colors hover-lift"
                                            >
                                                <div className="flex items-center mb-2">
                                                    <i className={`${item.icon} text-blue-500 mr-2`}></i>
                                                    <span className="font-medium text-sm">{item.title}</span>
                                                </div>
                                                <p className="text-sm text-gray-600 dark:text-gray-400">{item.prompt}</p>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            ) : (
                                // Messages
                                <div className="max-w-4xl mx-auto px-4 py-6 space-y-6">
                                    {messages.map((message) => (
                                        <MessageBubble key={message.id} message={message} />
                                    ))}
                                    {isLoading && <TypingIndicator />}
                                    <div ref={messagesEndRef} />
                                </div>
                            )}
                        </div>
                        
                        {/* Input area */}
                        <div className="p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900">
                            <div className="max-w-4xl mx-auto">
                                <div className="relative">
                                    <textarea
                                        ref={inputRef}
                                        value={input}
                                        onChange={(e) => setInput(e.target.value)}
                                        onKeyPress={handleKeyPress}
                                        placeholder="Message ChatAI..."
                                        className="w-full px-4 py-3 pr-12 border border-gray-300 dark:border-gray-600 rounded-xl resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        rows={1}
                                        style={{
                                            minHeight: '50px',
                                            maxHeight: '120px'
                                        }}
                                        onInput={(e) => {
                                            e.target.style.height = 'auto';
                                            e.target.style.height = Math.min(e.target.scrollHeight, 120) + 'px';
                                        }}
                                        disabled={isLoading}
                                    />
                                    <button
                                        onClick={handleSendMessage}
                                        disabled={!input.trim() || isLoading}
                                        className={`absolute right-3 top-1/2 transform -translate-y-1/2 p-2 rounded-lg transition-all ${
                                            input.trim() && !isLoading
                                                ? 'bg-blue-600 text-white hover:bg-blue-700 hover-lift'
                                                : 'bg-gray-200 dark:bg-gray-700 text-gray-400 cursor-not-allowed'
                                        }`}
                                    >
                                        {isLoading ? (
                                            <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                        ) : (
                                            <i className="fas fa-paper-plane text-sm"></i>
                                        )}
                                    </button>
                                </div>
                                <p className="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">
                                    Press Enter to send, Shift+Enter for new line
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    {/* Sidebar overlay for mobile */}
                    {sidebarOpen && (
                        <div 
                            className="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"
                            onClick={() => setSidebarOpen(false)}
                        ></div>
                    )}
                </div>
            );
        };
        
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>