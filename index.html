<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced AI Chat Assistant</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --secondary: #10b981;
            --dark: #1e293b;
            --light: #f8fafc;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: #f1f5f9;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* Animation classes */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: currentColor;
            margin: 0 2px;
            animation: bounce 1.4s infinite ease-in-out;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        /* Markdown-like styling for AI responses */
        .message-content p {
            margin-bottom: 0.75rem;
        }
        
        .message-content ul, .message-content ol {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
        }
        
        .message-content ul {
            list-style-type: disc;
        }
        
        .message-content ol {
            list-style-type: decimal;
        }
        
        .message-content li {
            margin-bottom: 0.25rem;
        }
        
        .message-content pre {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 0.75rem;
            border-radius: 0.375rem;
            overflow-x: auto;
            margin-bottom: 0.75rem;
            font-family: monospace;
        }
        
        .message-content code {
            font-family: monospace;
            background-color: rgba(0, 0, 0, 0.05);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }
        
        .message-content blockquote {
            border-left: 3px solid rgba(0, 0, 0, 0.1);
            padding-left: 1rem;
            margin-left: 0;
            margin-bottom: 0.75rem;
            color: rgba(0, 0, 0, 0.7);
        }
        
        .message-content a {
            color: var(--primary);
            text-decoration: underline;
        }
        
        .message-content a:hover {
            color: var(--primary-dark);
        }
        
        /* Pulse animation for new message indicator */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- React and ReactDOM CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // Sample quick questions for the user
        const QUICK_QUESTIONS = [
            "Explain quantum computing in simple terms",
            "What's the weather forecast for tomorrow?",
            "How do I make a perfect omelette?",
            "What are the latest trends in AI?",
            "Suggest a good book about productivity"
        ];

        // Sample chat themes
        const CHAT_THEMES = [
            { name: "Default", primary: "#4f46e5", secondary: "#10b981", bg: "#f8fafc" },
            { name: "Dark", primary: "#8b5cf6", secondary: "#ec4899", bg: "#1e293b" },
            { name: "Ocean", primary: "#3b82f6", secondary: "#06b6d4", bg: "#f0f9ff" },
            { name: "Forest", primary: "#10b981", secondary: "#84cc16", bg: "#f0fdf4" },
            { name: "Sunset", primary: "#f97316", secondary: "#ef4444", bg: "#fff7ed" }
        ];

        // Sample chat models
        const CHAT_MODELS = [
            { id: "gemini-flash", name: "Gemini Flash", description: "Fast and efficient for most tasks" },
            { id: "gemini-pro", name: "Gemini Pro", description: "Balanced performance and capability" },
            { id: "gemini-ultra", name: "Gemini Ultra", description: "Most advanced capabilities" }
        ];

        const App = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [isSettingsOpen, setIsSettingsOpen] = useState(false);
            const [theme, setTheme] = useState(CHAT_THEMES[0]);
            const [model, setModel] = useState(CHAT_MODELS[0]);
            const [characterCount, setCharacterCount] = useState(0);
            const [isNewMessage, setIsNewMessage] = useState(false);
            const [isMobileView, setIsMobileView] = useState(window.innerWidth < 768);
            const [isInputFocused, setIsInputFocused] = useState(false);
            const [conversationId, setConversationId] = useState(Date.now());
            
            const messagesEndRef = useRef(null);
            const inputRef = useRef(null);
            const fileInputRef = useRef(null);

            // Check for mobile view
            useEffect(() => {
                const handleResize = () => {
                    setIsMobileView(window.innerWidth < 768);
                };
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // Initial greeting message
            useEffect(() => {
                const welcomeMessage = {
                    id: Date.now(),
                    text: `Hi there! I'm your AI assistant. How can I help you today?\n\nYou can ask me anything or try one of these quick questions:`,
                    sender: 'system',
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    quickReplies: QUICK_QUESTIONS
                };
                setMessages([welcomeMessage]);
                
                // Generate a unique conversation ID
                setConversationId(Date.now());
            }, []);

            // Auto-scroll to bottom when messages change
            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            // Track character count
            useEffect(() => {
                setCharacterCount(input.length);
            }, [input]);

            // Apply theme
            useEffect(() => {
                document.documentElement.style.setProperty('--primary', theme.primary);
                document.documentElement.style.setProperty('--primary-dark', theme.primary);
                document.documentElement.style.setProperty('--secondary', theme.secondary);
                document.documentElement.style.setProperty('--dark', '#1e293b');
                document.documentElement.style.setProperty('--light', theme.bg);
            }, [theme]);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            const generateResponse = async (userQuery, conversationHistory) => {
                setIsLoading(true);
                setIsNewMessage(false);
                
                let chatHistory = conversationHistory.map(msg => ({
                    role: msg.sender === 'user' ? 'user' : 'model',
                    parts: [{ text: msg.text }]
                }));
                chatHistory.push({ role: "user", parts: [{ text: userQuery }] });

                const payload = { 
                    contents: chatHistory,
                    generationConfig: {
                        temperature: 0.7,
                        topP: 0.9,
                        topK: 40
                    }
                };

                const apiKey = "AIzaSyCo5pNBIH09u4OKfTVhLPAwwg_EpKPRHsM";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        console.error("API Error:", errorData);
                        throw new Error(`API error: ${response.status} ${response.statusText}`);
                    }

                    const result = await response.json();
                    if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        console.warn("Unexpected API response structure:", result);
                        return "I'm sorry, I couldn't generate a response. Please try again.";
                    }
                } catch (error) {
                    console.error("Error fetching from Gemini API:", error);
                    return "Oops! There was an issue connecting to the AI. Please try again later.";
                } finally {
                    setIsLoading(false);
                }
            };

            const handleSendMessage = async () => {
                const trimmedInput = input.trim();
                if (!trimmedInput || isLoading) return;

                const newUserMessage = {
                    id: Date.now(),
                    text: trimmedInput,
                    sender: 'user',
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };
                
                setMessages(prev => [...prev, newUserMessage]);
                setInput('');
                setIsNewMessage(true);

                try {
                    const responseText = await generateResponse(trimmedInput, [...messages, newUserMessage]);
                    
                    const newSystemMessage = {
                        id: Date.now() + 1,
                        text: responseText,
                        sender: 'system',
                        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                    };
                    
                    setMessages(prev => [...prev, newSystemMessage]);
                } catch (error) {
                    console.error("Error handling message send:", error);
                    setMessages(prev => [...prev, {
                        id: Date.now() + 1,
                        text: "An error occurred while getting a response. Please try again.",
                        sender: 'system',
                        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                    }]);
                }
            };

            const handleQuickReply = (reply) => {
                setInput(reply);
                inputRef.current.focus();
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            const handleNewChat = () => {
                setMessages([]);
                setConversationId(Date.now());
                setIsMenuOpen(false);
                
                // New welcome message
                setTimeout(() => {
                    const welcomeMessage = {
                        id: Date.now(),
                        text: `Hi there! I'm your AI assistant. How can I help you today?\n\nYou can ask me anything or try one of these quick questions:`,
                        sender: 'system',
                        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                        quickReplies: QUICK_QUESTIONS
                    };
                    setMessages([welcomeMessage]);
                }, 300);
            };

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                // Check file size (limit to 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('File size should be less than 5MB');
                    return;
                }
                
                // Create a preview and add as a message
                const reader = new FileReader();
                reader.onload = (event) => {
                    const fileMessage = {
                        id: Date.now(),
                        text: `[File: ${file.name}]`,
                        sender: 'user',
                        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                        file: {
                            name: file.name,
                            type: file.type,
                            size: file.size,
                            url: event.target.result
                        }
                    };
                    
                    setMessages(prev => [...prev, fileMessage]);
                    
                    // Auto-scroll to show the new message
                    setTimeout(() => {
                        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
                    }, 100);
                };
                
                reader.readAsDataURL(file);
            };

            const formatMessageText = (text) => {
                // Simple markdown parsing for better formatting
                let formatted = text;
                
                // Headers
                formatted = formatted.replace(/^# (.*$)/gm, '<h1 class="text-xl font-bold mt-4 mb-2">$1</h1>');
                formatted = formatted.replace(/^## (.*$)/gm, '<h2 class="text-lg font-bold mt-3 mb-1">$1</h2>');
                formatted = formatted.replace(/^### (.*$)/gm, '<h3 class="font-bold mt-2">$1</h3>');
                
                // Bold and italic
                formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                // Code blocks
                formatted = formatted.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
                formatted = formatted.replace(/`(.*?)`/g, '<code>$1</code>');
                
                // Links
                formatted = formatted.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:underline">$1</a>');
                
                // Lists
                formatted = formatted.replace(/^\s*\*\s(.*$)/gm, '<li>$1</li>');
                formatted = formatted.replace(/^\s*-\s(.*$)/gm, '<li>$1</li>');
                formatted = formatted.replace(/^\s*\+\s(.*$)/gm, '<li>$1</li>');
                
                // Paragraphs
                formatted = formatted.replace(/([^\n])\n([^\n])/g, '$1<br>$2');
                
                // Blockquotes
                formatted = formatted.replace(/^>\s(.*$)/gm, '<blockquote>$1</blockquote>');
                
                return formatted;
            };

            const renderFilePreview = (file) => {
                if (file.type.startsWith('image/')) {
                    return (
                        <div className="mt-2 rounded-lg overflow-hidden border border-gray-200">
                            <img src={file.url} alt={file.name} className="max-w-full max-h-64 object-contain" />
                            <div className="p-2 bg-gray-50 text-xs text-gray-500">
                                {file.name} ({formatFileSize(file.size)})
                            </div>
                        </div>
                    );
                } else if (file.type.startsWith('video/')) {
                    return (
                        <div className="mt-2 rounded-lg overflow-hidden border border-gray-200">
                            <video controls className="max-w-full max-h-64">
                                <source src={file.url} type={file.type} />
                                Your browser does not support the video tag.
                            </video>
                            <div className="p-2 bg-gray-50 text-xs text-gray-500">
                                {file.name} ({formatFileSize(file.size)})
                            </div>
                        </div>
                    );
                } else if (file.type.startsWith('audio/')) {
                    return (
                        <div className="mt-2 rounded-lg overflow-hidden border border-gray-200">
                            <audio controls className="w-full">
                                <source src={file.url} type={file.type} />
                                Your browser does not support the audio element.
                            </audio>
                            <div className="p-2 bg-gray-50 text-xs text-gray-500">
                                {file.name} ({formatFileSize(file.size)})
                            </div>
                        </div>
                    );
                } else {
                    return (
                        <div className="mt-2 p-3 bg-gray-100 rounded-lg text-sm">
                            <div className="flex items-center">
                                <i className="far fa-file-alt mr-2 text-gray-500"></i>
                                <span>{file.name}</span>
                            </div>
                            <div className="text-xs text-gray-500 mt-1">
                                {formatFileSize(file.size)} - {file.type || 'Unknown file type'}
                            </div>
                        </div>
                    );
                }
            };

            const formatFileSize = (bytes) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                    // Show a temporary tooltip or notification
                    const notification = document.createElement('div');
                    notification.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg text-sm';
                    notification.textContent = 'Copied to clipboard!';
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            };

            return (
                <div className={`flex flex-col h-screen bg-gray-50 transition-colors duration-300 ${theme.bg === '#1e293b' ? 'dark' : ''}`}>
                    {/* Header */}
                    <header className="bg-gradient-to-r from-primary to-primary-dark text-white p-4 shadow-md flex items-center justify-between sticky top-0 z-10">
                        <div className="flex items-center space-x-3">
                            <button 
                                onClick={() => setIsMenuOpen(!isMenuOpen)}
                                className="p-2 rounded-full hover:bg-white/10 transition-colors"
                                aria-label="Menu"
                            >
                                <i className={`fas ${isMenuOpen ? 'fa-times' : 'fa-bars'}`}></i>
                            </button>
                            <h1 className="text-xl font-bold">AI Chat Assistant</h1>
                        </div>
                        <div className="flex items-center space-x-3">
                            <button 
                                onClick={() => setIsSettingsOpen(!isSettingsOpen)}
                                className="p-2 rounded-full hover:bg-white/10 transition-colors"
                                aria-label="Settings"
                            >
                                <i className="fas fa-cog"></i>
                            </button>
                            <div className="text-xs bg-white/20 px-2 py-1 rounded-full">
                                {model.name}
                            </div>
                        </div>
                    </header>

                    {/* Sidebar Menu */}
                    {isMenuOpen && (
                        <div className="fixed inset-0 z-20">
                            <div 
                                className="absolute inset-0 bg-black/50" 
                                onClick={() => setIsMenuOpen(false)}
                            ></div>
                            <div className="absolute left-0 top-0 bottom-0 w-64 bg-white shadow-xl transform transition-transform duration-300">
                                <div className="p-4 border-b border-gray-200">
                                    <h2 className="text-lg font-semibold text-gray-800">Chat Menu</h2>
                                </div>
                                <div className="p-4">
                                    <button 
                                        onClick={handleNewChat}
                                        className="w-full flex items-center space-x-2 p-3 rounded-lg hover:bg-gray-100 text-gray-700 transition-colors"
                                    >
                                        <i className="far fa-plus-square"></i>
                                        <span>New Chat</span>
                                    </button>
                                    <button 
                                        className="w-full flex items-center space-x-2 p-3 rounded-lg hover:bg-gray-100 text-gray-700 transition-colors mt-2"
                                        onClick={() => {
                                            setIsMenuOpen(false);
                                            setIsSettingsOpen(true);
                                        }}
                                    >
                                        <i className="fas fa-cog"></i>
                                        <span>Settings</span>
                                    </button>
                                </div>
                                <div className="p-4 border-t border-gray-200">
                                    <h3 className="text-sm font-medium text-gray-500 mb-2">Conversation History</h3>
                                    <div className="text-sm text-gray-500 italic">
                                        History feature coming soon!
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Settings Panel */}
                    {isSettingsOpen && (
                        <div className="fixed inset-0 z-20">
                            <div 
                                className="absolute inset-0 bg-black/50" 
                                onClick={() => setIsSettingsOpen(false)}
                            ></div>
                            <div className="absolute right-0 top-0 bottom-0 w-80 bg-white shadow-xl transform transition-transform duration-300 overflow-y-auto">
                                <div className="p-4 border-b border-gray-200">
                                    <h2 className="text-lg font-semibold text-gray-800">Settings</h2>
                                </div>
                                <div className="p-4 space-y-6">
                                    <div>
                                        <h3 className="text-sm font-medium text-gray-700 mb-2">Chat Model</h3>
                                        <div className="space-y-2">
                                            {CHAT_MODELS.map((m) => (
                                                <div 
                                                    key={m.id}
                                                    onClick={() => setModel(m)}
                                                    className={`p-3 rounded-lg border cursor-pointer transition-colors ${model.id === m.id ? 'border-primary bg-primary/10' : 'border-gray-200 hover:border-primary'}`}
                                                >
                                                    <div className="font-medium">{m.name}</div>
                                                    <div className="text-xs text-gray-500">{m.description}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h3 className="text-sm font-medium text-gray-700 mb-2">Theme</h3>
                                        <div className="grid grid-cols-3 gap-2">
                                            {CHAT_THEMES.map((t) => (
                                                <div 
                                                    key={t.name}
                                                    onClick={() => setTheme(t)}
                                                    className={`p-2 rounded-lg border cursor-pointer transition-colors ${theme.name === t.name ? 'border-primary ring-2 ring-primary/30' : 'border-gray-200 hover:border-primary'}`}
                                                >
                                                    <div className="flex items-center space-x-2">
                                                        <div 
                                                            className="w-4 h-4 rounded-full" 
                                                            style={{ backgroundColor: t.primary }}
                                                        ></div>
                                                        <div 
                                                            className="w-4 h-4 rounded-full" 
                                                            style={{ backgroundColor: t.secondary }}
                                                        ></div>
                                                    </div>
                                                    <div className="text-xs mt-1 text-center">{t.name}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h3 className="text-sm font-medium text-gray-700 mb-2">Preferences</h3>
                                        <div className="space-y-3">
                                            <label className="flex items-center space-x-2">
                                                <input type="checkbox" className="rounded text-primary focus:ring-primary" />
                                                <span className="text-sm">Enable notifications</span>
                                            </label>
                                            <label className="flex items-center space-x-2">
                                                <input type="checkbox" className="rounded text-primary focus:ring-primary" defaultChecked />
                                                <span className="text-sm">Auto-scroll to new messages</span>
                                            </label>
                                            <label className="flex items-center space-x-2">
                                                <input type="checkbox" className="rounded text-primary focus:ring-primary" defaultChecked />
                                                <span className="text-sm">Show typing indicators</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Main Chat Area */}
                    <div className="flex-1 overflow-y-auto p-4 pb-20">
                        <div className="max-w-3xl mx-auto w-full space-y-4">
                            {messages.map((message, index) => (
                                <div 
                                    key={message.id}
                                    className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'} fade-in`}
                                    style={{ animationDelay: `${index * 0.05}s` }}
                                >
                                    <div
                                        className={`max-w-[85%] p-3 rounded-xl shadow-sm relative group
                                            ${message.sender === 'user'
                                                ? 'bg-primary text-white rounded-br-none'
                                                : 'bg-white text-gray-800 rounded-bl-none border border-gray-200'
                                            }`}
                                    >
                                        {/* Message content with basic markdown support */}
                                        {message.sender === 'system' ? (
                                            <div 
                                                className="message-content text-sm break-words" 
                                                dangerouslySetInnerHTML={{ __html: formatMessageText(message.text) }}
                                            ></div>
                                        ) : (
                                            <div className="text-sm break-words">{message.text}</div>
                                        )}
                                        
                                        {/* File preview if message has a file */}
                                        {message.file && renderFilePreview(message.file)}
                                        
                                        {/* Message timestamp and actions */}
                                        <div className={`absolute -bottom-5 text-xs text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center
                                            ${message.sender === 'user' ? 'right-2' : 'left-2'}`}
                                        >
                                            <span>{message.timestamp}</span>
                                            {message.sender === 'system' && (
                                                <button 
                                                    onClick={() => copyToClipboard(message.text)}
                                                    className="ml-2 text-gray-400 hover:text-gray-600"
                                                    title="Copy to clipboard"
                                                >
                                                    <i className="far fa-copy text-xs"></i>
                                                </button>
                                            )}
                                        </div>
                                        
                                        {/* Quick replies for system messages */}
                                        {message.quickReplies && (
                                            <div className="mt-3 pt-2 border-t border-white/20">
                                                <div className="text-xs text-white/70 mb-1">Try asking:</div>
                                                <div className="flex flex-wrap gap-2">
                                                    {message.quickReplies.map((reply, i) => (
                                                        <button
                                                            key={i}
                                                            onClick={() => handleQuickReply(reply)}
                                                            className="text-xs bg-white/10 hover:bg-white/20 px-2 py-1 rounded-full transition-colors"
                                                        >
                                                            {reply}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            ))}
                            
                            {/* Loading indicator */}
                            {isLoading && (
                                <div className="flex justify-start fade-in">
                                    <div className="bg-white text-gray-800 p-3 rounded-xl rounded-bl-none shadow-sm border border-gray-200 max-w-[85%]">
                                        <div className="flex items-center space-x-2 text-sm">
                                            <div className="typing-indicator text-gray-500">
                                                <span></span>
                                                <span></span>
                                                <span></span>
                                            </div>
                                            <span>AI is typing...</span>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* New message indicator */}
                            {isNewMessage && (
                                <div className="flex justify-center">
                                    <div className="text-xs bg-primary text-white px-2 py-1 rounded-full flex items-center pulse">
                                        <i className="fas fa-arrow-down mr-1"></i>
                                        <span>New message</span>
                                    </div>
                                </div>
                            )}
                            
                            <div ref={messagesEndRef} />
                        </div>
                    </div>

                    {/* Input Area */}
                    <div className={`fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg transition-transform duration-300 ${isInputFocused && isMobileView ? 'transform translate-y-0' : ''}`}>
                        <div className="max-w-3xl mx-auto p-4 w-full">
                            {/* Character counter and upload button */}
                            <div className="flex justify-between items-center mb-2">
                                <button 
                                    onClick={() => fileInputRef.current.click()}
                                    className="text-gray-500 hover:text-primary transition-colors p-1"
                                    title="Attach file"
                                >
                                    <i className="fas fa-paperclip"></i>
                                    <input 
                                        type="file" 
                                        ref={fileInputRef}
                                        onChange={handleFileUpload}
                                        className="hidden"
                                        accept="image/*, video/*, audio/*, .pdf, .doc, .docx, .txt"
                                    />
                                </button>
                                <div className="text-xs text-gray-500">
                                    {characterCount}/2000
                                </div>
                            </div>
                            
                            {/* Text input */}
                            <div className="flex items-end space-x-3">
                                <div className="flex-1 relative">
                                    <textarea
                                        ref={inputRef}
                                        className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none text-sm"
                                        placeholder="Type your message here..."
                                        value={input}
                                        onChange={(e) => setInput(e.target.value)}
                                        onKeyPress={handleKeyPress}
                                        maxLength={2000}
                                        disabled={isLoading}
                                        rows={1}
                                        style={{ minHeight: '44px', maxHeight: '120px' }}
                                        onFocus={() => setIsInputFocused(true)}
                                        onBlur={() => setIsInputFocused(false)}
                                    />
                                    {!input && (
                                        <div className="absolute bottom-3 right-3 text-xs text-gray-400">
                                            Shift+Enter for new line
                                        </div>
                                    )}
                                </div>
                                <button
                                    onClick={handleSendMessage}
                                    className={`bg-primary hover:bg-primary-dark text-white font-medium p-3 rounded-lg shadow-md transition-colors duration-300 flex items-center justify-center ${isLoading || !input.trim() ? 'opacity-50 cursor-not-allowed' : 'hover:scale-105'}`}
                                    disabled={isLoading || !input.trim()}
                                    style={{ minWidth: '44px', minHeight: '44px' }}
                                >
                                    {isLoading ? (
                                        <i className="fas fa-spinner fa-pulse"></i>
                                    ) : (
                                        <i className="fas fa-paper-plane"></i>
                                    )}
                                </button>
                            </div>
                            
                            {/* Quick action buttons */}
                            <div className="flex justify-center space-x-4 mt-3">
                                <button 
                                    onClick={() => handleQuickReply("Summarize this conversation")}
                                    className="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full transition-colors text-gray-700 flex items-center"
                                >
                                    <i className="fas fa-clipboard-list mr-1"></i>
                                    <span>Summarize</span>
                                </button>
                                <button 
                                    onClick={() => handleQuickReply("Translate the last message to Spanish")}
                                    className="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full transition-colors text-gray-700 flex items-center"
                                >
                                    <i className="fas fa-language mr-1"></i>
                                    <span>Translate</span>
                                </button>
                                <button 
                                    onClick={() => handleQuickReply("Explain this in simpler terms")}
                                    className="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-full transition-colors text-gray-700 flex items-center"
                                >
                                    <i className="fas fa-lightbulb mr-1"></i>
                                    <span>Simplify</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the React App component into the root div
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
